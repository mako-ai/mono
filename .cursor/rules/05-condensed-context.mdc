---
alwaysApply: true
description: Ultra-condensed context for RevOps (99% signal)
---

# RevOps Quick Context

- API entry: [api/src/index.ts](mdc:api/src/index.ts); default port `WEB_API_PORT=8080`.
- App entry: [app/src/main.tsx](mdc:app/src/main.tsx); Vite dev on 5173; proxy `/api` -> `http://localhost:8080` ([app/vite.config.ts](mdc:app/vite.config.ts)).
- Env (local): `DATABASE_URL`, `WEB_API_PORT=8080`, `BASE_URL=http://localhost:8080`, `CLIENT_URL=http://localhost:5173`.

Auth

- Prefer `unifiedAuthMiddleware`: [api/src/auth/unified-auth.middleware.ts](mdc:api/src/auth/unified-auth.middleware.ts).
- Sessions via Lucia: [api/src/auth/lucia.ts](mdc:api/src/auth/lucia.ts) + [api/src/auth/mongodb-adapter.ts](mdc:api/src/auth/mongodb-adapter.ts).
- OAuth providers: [api/src/auth/arctic.ts](mdc:api/src/auth/arctic.ts) (uses `BASE_URL`).
- Routes mounted at `/api/auth`: [api/src/auth/auth.controller.ts](mdc:api/src/auth/auth.controller.ts).

MongoDB

- Schemas: [api/src/database/schema.ts](mdc:api/src/database/schema.ts), [api/src/database/workspace-schema.ts](mdc:api/src/database/workspace-schema.ts).
- Use connection service: [api/src/services/database-connection.service.ts](mdc:api/src/services/database-connection.service.ts) (do not new `MongoClient`).

Sync & Connectors

- CLI entry: `pnpm run sync` â†’ [api/src/sync/cli.ts](mdc:api/src/sync/cli.ts).
- CLI connector registry (lazy): [api/src/sync/connector-registry.ts](mdc:api/src/sync/connector-registry.ts).
- API runtime registry: [api/src/connectors/registry.ts](mdc:api/src/connectors/registry.ts).
- Connectors: [api/src/connectors/\*\*](mdc:api/src/connectors); implementations in `connector.ts` files.
- Chunked/resumable fetching interfaces: [api/src/connectors/base/BaseConnector.ts](mdc:api/src/connectors/base/BaseConnector.ts).
- Entities: Close (`leads, opportunities, activities, contacts, users, custom_fields`); Stripe (`customers, subscriptions, charges, invoices, products, plans`); GraphQL (per configured query names).

Query Runner

- Location: [api/src/sync/query-runner.ts](mdc:api/src/sync/query-runner.ts); reads JSON aggregation pipeline; selects MongoDB source by ID; uses connection service.

Routing & Jobs

- Main routers mounted in index: consoles, execute, database, sources, connectors, workspaces, sync-jobs, webhooks.
- Inngest endpoint: `GET|PUT|POST /api/inngest` from [api/src/inngest](mdc:api/src/inngest).

Build & Scripts

- Dev: `pnpm run dev` (API + App + Inngest dev).
- Build: `pnpm run build`. Do not edit `dist/**`.
